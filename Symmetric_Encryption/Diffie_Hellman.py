import random

# --- 1. р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕кр╕▓р╕Шр╕▓р╕гр╕Ур╕░ (Public Parameters) ---
# р╣Гр╕Др╕гр╣Ж р╕Бр╣Зр╕гр╕╣р╣Йр╕Др╣Ир╕▓р╕Щр╕╡р╣Йр╣Др╕Фр╣Й р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕Ыр╕┤р╕Фр╕Ър╕▒р╕З (р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕лр╕бр╕╖р╕нр╕Щ "р╕кр╕╡р╣Ар╕лр╕ер╕╖р╕нр╕З" р╣Гр╕Щр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З)
# р╣Гр╕Щр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З p р╕Хр╣Йр╕нр╕Зр╣Ар╕Ыр╣Зр╕Щр╕Ир╕│р╕Щр╕зр╕Щр╣Ар╕Йр╕Юр╕▓р╕░р╕Вр╕Щр╕▓р╕Фр╣Гр╕лр╕Нр╣Ир╕бр╕▓р╕Б (р╣Ар╕Кр╣Ир╕Щ 2048 bit)
p = 23  # Prime number (р╕Ир╕│р╕Щр╕зр╕Щр╣Ар╕Йр╕Юр╕▓р╕░)
g = 5   # Generator (р╕Рр╕▓р╕Щ)

print(f"ЁЯУв р╕Др╣Ир╕▓р╕кр╕▓р╕Шр╕▓р╕гр╕Ур╕░: p={p}, g={g}")
print("-" * 50)

# --- 2. р╕Эр╕▒р╣Ир╕З Alice (р╕Ир╕│р╕ер╕нр╕З) ---
# Alice р╕кр╕╕р╣Ир╕бр╣Ар╕ер╕Вр╕ер╕▒р╕Ър╕Вр╕нр╕Зр╕Хр╕▒р╕зр╣Ар╕нр╕З (Private Key) -> р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕лр╕бр╕╖р╕нр╕Щ "р╕кр╕╡р╣Бр╕Фр╕З"
a = random.randint(1, 10) 
# Alice р╕Др╕│р╕Щр╕зр╕Ур╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕Ир╕░р╕кр╣Ир╕Зр╣Гр╕лр╣Й Bob (Public Key р╕Вр╕нр╕З Alice) -> р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕лр╕бр╕╖р╕нр╕Щ "р╕кр╕╡р╕кр╣Йр╕б"
A = (g ** a) % p 

print(f"ЁЯСй Alice: р╣Ар╕ер╕Вр╕ер╕▒р╕Ъ(a) = {a} | р╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕нр╕нр╕Б(A) = {A}")

# --- 3. р╕Эр╕▒р╣Ир╕З Bob (р╕Ир╕│р╕ер╕нр╕З) ---
# Bob р╕кр╕╕р╣Ир╕бр╣Ар╕ер╕Вр╕ер╕▒р╕Ър╕Вр╕нр╕Зр╕Хр╕▒р╕зр╣Ар╕нр╕З (Private Key) -> р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕лр╕бр╕╖р╕нр╕Щ "р╕кр╕╡р╣Ар╕Вр╕╡р╕вр╕з"
b = random.randint(1, 10)
# Bob р╕Др╕│р╕Щр╕зр╕Ур╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕Ир╕░р╕кр╣Ир╕Зр╣Гр╕лр╣Й Alice (Public Key р╕Вр╕нр╕З Bob) -> р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕лр╕бр╕╖р╕нр╕Щ "р╕кр╕╡р╕Яр╣Йр╕▓"
B = (g ** b) % p

print(f"ЁЯСи Bob:   р╣Ар╕ер╕Вр╕ер╕▒р╕Ъ(b) = {b} | р╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕кр╣Ир╕Зр╕нр╕нр╕Б(B) = {B}")
print("-" * 50)

# --- 4. р╕Бр╕▓р╕гр╣Бр╕ер╕Бр╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╣Бр╕ер╕░р╕Др╕│р╕Щр╕зр╕Ур╕Др╕зр╕▓р╕бр╕ер╕▒р╕Ър╕гр╣Ир╕зр╕бр╕Бр╕▒р╕Щ (Shared Secret) ---
# р╣Ар╕Ыр╕гр╕╡р╕вр╕Ър╣Ар╕лр╕бр╕╖р╕нр╕Щр╕Бр╕▓р╕гр╣Ар╕нр╕▓р╕кр╕╡р╕Чр╕╡р╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕бр╕▓р╕Ьр╕кр╕бр╕Бр╕▒р╕Ър╕кр╕╡р╕ер╕▒р╕Ър╕Вр╕нр╕Зр╕Хр╕▒р╕зр╣Ар╕нр╕З р╕Ир╕Щр╣Др╕Фр╣Й "р╕кр╕╡р╕Щр╣Йр╕│р╕Хр╕▓р╕е"

# Alice р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕Др╣Ир╕▓ B р╕Ир╕▓р╕Б Bob -> р╣Ар╕нр╕▓р╕бр╕▓р╕Др╕│р╕Щр╕зр╕У
alice_secret = (B ** a) % p

# Bob р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕Др╣Ир╕▓ A р╕Ир╕▓р╕Б Alice -> р╣Ар╕нр╕▓р╕бр╕▓р╕Др╕│р╕Щр╕зр╕У
bob_secret = (A ** b) % p

print(f"ЁЯФР р╕Др╕зр╕▓р╕бр╕ер╕▒р╕Ър╕Чр╕╡р╣И Alice р╕Др╕│р╕Щр╕зр╕Ур╣Др╕Фр╣Й: {alice_secret}")
print(f"ЁЯФР р╕Др╕зр╕▓р╕бр╕ер╕▒р╕Ър╕Чр╕╡р╣И Bob   р╕Др╕│р╕Щр╕зр╕Ур╣Др╕Фр╣Й: {bob_secret}")

if alice_secret == bob_secret:
    print("\nтЬЕ р╕кр╕╕р╕Фр╕вр╕нр╕Ф! р╕Чр╕▒р╣Йр╕Зр╕Др╕╣р╣Ир╣Др╕Фр╣Й Secret Key р╕Хр╕гр╕Зр╕Бр╕▒р╕Щ р╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕кр╣Ир╕З Key р╕лр╕▓р╕Бр╕▒р╕Щр╣Ар╕ер╕в")
else:
    print("\nтЭМ р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з! р╕Др╣Ир╕▓р╣Др╕бр╣Ир╕Хр╕гр╕Зр╕Бр╕▒р╕Щ")